var e,t,a,n,l,r,s,o,c,i,u,m,d,b,h,p,v,f,g=Object.defineProperty,x=Object.defineProperties,y=Object.getOwnPropertyDescriptors,N=Object.getOwnPropertySymbols,w=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable,S=(e,t,a)=>t in e?g(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,T=(e,t)=>{for(var a in t||(t={}))w.call(t,a)&&S(e,a,t[a]);if(N)for(var a of N(t))C.call(t,a)&&S(e,a,t[a]);return e},E=(e,t)=>x(e,y(t));import{v as I,d as O,l as k,F as A,D as B,y as L,S as j}from"./vendor.cec4665d.js";(e||(e={})).Lambda="Lambda",(a=t||(t={})).And="And",a.Or="Or",a.Not="Not",(l=n||(n={})).IsBefore="IsBefore",l.IsAfter="IsAfter",l.IsBetween="IsBetween",(s=r||(r={})).MoreThan="MoreThan",s.LessThan="LessThan",s.MoreThanOrEqual="MoreThanOrEqual",s.LessThanOrEqual="LessThanOrEqual",s.Equal="Equal",(c=o||(o={})).Is="Is",c.IsNot="IsNot",(u=i||(i={})).IsChecked="IsChecked",u.IsNotChecked="IsNotChecked",(d=m||(m={})).AllOf="AllOf",d.NoneOf="NoneOf",d.AnyOf="AnyOf",d.NumberOf="NoneOf",(h=b||(b={})).Exists="Exists",h.ExistsAnd="ExistsAnd",(p||(p={})).Lookup="Lookup",(f=v||(v={}))[f.Date=0]="Date",f[f.Number=1]="Number",f[f.Enum=2]="Enum",f[f.Boolean=3]="Boolean",f[f.Collection=4]="Collection",f[f.Optional=5]="Optional",f[f.Model=6]="Model";const M=[0,1,2,3,4,5];function D(e){const t={name:"Gathering",attributes:[{label:"Group",type:v.Collection,subtype:"Person"},{label:"All from same household",type:v.Boolean}]},a={name:"Person",attributes:[{label:"Age",type:v.Number},{label:"Is fully vaccinated",type:v.Boolean},{label:"Type of vaccine",type:v.Enum,enumSet:["Pfizer","Moderna","Sinovac","Other"]},{label:"Date of vaccination",type:v.Date}]},n={name:"Insolvency",attributes:[{label:"Debt",type:v.Number},{label:"Written demand has been made to company's registered office, and the debtor has failed to pay, secure or compound the sum within 3 weeks",type:v.Boolean},{label:"Judgment has been issued in favor of a creditor, which has not been fully complied with",type:v.Boolean},{label:"Debtor is able to pay debt as it falls due",type:v.Boolean}]};switch(e){case"Person":return a;case"Insolvency":return n;default:return t}}function P(e){return{label:e.name,attributes:e.attributes.map((e=>R(e))),type:v.Model}}const R=e=>{switch(e.type){case v.Boolean:return E(T({},e),{value:!0});case v.Number:return E(T({},e),{value:0});case v.Collection:return E(T({},e),{value:[]});default:return E(T({},e),{value:void 0})}};function H(e){const t=e.model,a=e.schema,n=a=>{console.log(a.currentTarget.name+": "+a.currentTarget.value);const n=t.attributes.slice(),l=t.attributes.findIndex((e=>e.label===a.currentTarget.name));n[l]=E(T({},n[l]),{value:a.currentTarget.value}),e.onChange(E(T({},t),{attributes:n}))},l=(t,a,n)=>{const l=a.attributes.slice(),r=a.attributes.findIndex((e=>e.label===n));l[r]=E(T({},l[r]),{value:t}),e.onChange(E(T({},a),{attributes:l}))},r=[];for(let s of t.attributes){if(s.type===v.Collection){const e=D(a.attributes.find((e=>e.label===s.label)).subtype),n=s.label;let o={value:s.value};r.push(I(G,E(T({},o),{onChange:e=>l(e,t,s.label),subSchema:e,collectionLabel:n})))}if(s.type===v.Boolean&&r.push(I("div",{className:"flex mt-2"},I("h2",{className:"text-lg inline w-1/4"},s.label),I("select",{className:"border-2 h-12 pl-2 text-lg py-2",onChange:n,name:s.label,value:s.value},I("option",{value:"true"},"Yes"),I("option",{value:"false"},"No")))),s.type===v.Number&&r.push(I("div",{className:"flex mt-2"},I("h2",{className:"text-lg inline w-1/4"},s.label),I("input",{type:"number",className:"border-2 h-12 pl-4 text-lg py-2",onChange:n,name:s.label,value:s.value}))),s.type===v.Enum){const e=a.attributes.find((e=>e.label===s.label)).enumSet.map((e=>I("option",{value:e},e)));r.push(I("div",{className:"flex mt-2"},I("h2",{className:"text-lg inline w-1/4"},s.label),I("select",{className:"border-2 h-12 pl-4 text-lg py-2",value:s.value,onChange:n,name:s.label},e)))}s.type===v.Date&&r.push(I("div",{className:"flex mt-2"},I("h2",{className:"text-lg inline w-1/4"},s.label),I("input",{type:"date",className:"border-2 h-12 pl-4 text-lg py-2",onChange:n,name:s.label,value:s.value})))}return I(O,null,I("div",{class:"w-11/12 min-w-max bg-white p-4 ml-1 border-2"},I("h1",{class:"text-2xl border-gray-300 text-gray-900 text-left"},t.label),r))}const G=e=>{const t=e.subSchema;console.log("props value"),console.log(e.value);const a=[],n=(e,t,a)=>{const n=t.value.slice();n[a]=e,t.onChange(n)},l=t=>{const a=e.value.slice();a.splice(t,1),e.onChange(a)};for(const[r,s]of e.value.entries())a.push(I("div",{className:"flex",key:r},I("div",{className:"text-lg w-24 border-2 flex flex-col justify-center items-center"},r+1,I("div",{className:"border-2 hover:bg-red-600 hover:text-white cursor-pointer text-sm py-2 px-2 mt-10",onClick:()=>l(r)},"Delete")),I("div",{className:"flex-1"},I(H,{model:s,onChange:t=>n(t,e,r),schema:t}))));return I("div",{className:"border-2 p-4 my-4"},I("div",{className:"mt-2"},I("h2",{className:"text-lg mb-2"},e.collectionLabel," (a group consisting of multiple ",e.subSchema.name,")"),a),I("div",{className:"addSubModel border-2 mt-6 w-max px-4 py-4 cursor-pointer hover:bg-indigo-600 hover:text-white\n      text-center font-semibold",onClick:()=>{console.log("new submodel");const a=e.value.slice();a.push(P(t)),e.onChange(a)}},"Add new ",e.subSchema.name))};var q,W,U;function V(e){const t=D(e.schemaStr),a=P(t),[n,l]=k(a);return I(O,null,I("div",{className:"mt-16"},I("button",{className:"border-2 w-48 py-4 px-4 text-lg hover:bg-indigo-600 hover:text-white text-center font-semibold",onClick:e.handleBack},"Back to scenario selection")),I("div",{className:"mt-4"},I("h1",null,"CONSUMER VIEW"),I(H,{model:n,onChange:e=>{l(e)},schema:t})),I("div",{className:"mt-12 flex justify-center"},I("button",{className:"submit border-2 w-max px-4 py-4 cursor-pointer hover:bg-indigo-600 hover:text-white\n      text-center font-semibold"},"Submit")))}(W=q||(q={})).Edit="edit",W.Select="select",function(e){e.Edit="edit",e.Select="select"}(U||(U={}));const F=["Group","Insolvency"];function J({store:e}){const[t,a]=k("Group"),n=D("Group"),[l,r]=k(U.Select),s=()=>{r(U.Select)};return P(n),I("div",{className:"px-24"},((e,a)=>{switch(e){case U.Edit:return I(V,{schemaStr:t,handleBack:s});case U.Select:const e=[];for(let t of F)e.push(I("div",{className:"w-72 flex border-2 py-12 justify-center content-evenly text-2xl cursor-pointer hover:bg-indigo-600 hover:text-white",name:t,onClick:()=>a(t)},t));return I(O,null,I("h1",{class:"text-2xl border-gray-300 text-gray-900 mt-16"},"Select a situation to get started."),I("div",{class:"w-11/12 mt-16 bg-white p-4 ml-1 border-2 flex justify-evenly"},e))}})(l,(e=>{a(e),r(U.Edit)})))}const Y=({store:e})=>I("div",null,"RULESET EDITOR"),z=(e,t,a)=>{const n=e.slice(0);return n[t]=a,n},X=({schema:e,updateHandler:t,schemaSpace:a})=>{const[n,l]=k(e),{attributes:r}=n,s=e=>t=>{l((a=>{const{attributes:n}=a;return E(T({},a),{attributes:z(n,e,t)})}))};return I("div",{className:"border-2 mt-12 px-12 py-8"},I("div",null,I("h1",{className:"text-2xl font-semibold"},"Schema builder"),I("div",{className:"mt-4"},I("input",{type:"text",label:"Name",placeholder:"Name of schema",value:n.name,onInput:e=>{if(e instanceof InputEvent&&e.currentTarget instanceof HTMLInputElement){const t=e.currentTarget.value;l((e=>E(T({},e),{name:t})))}},className:"border-2 text-xl py-2 px-2"})),I("h2",{className:"text-lg mt-6"},"Attributes:"),r.map(((e,t)=>I(K,{attribute:e,availableTypes:a,onChangeCallback:s(t)}))),I("div",{className:"mt-2"},I("button",{onClick:()=>{const e=r.concat({label:"",type:v.Boolean});l((t=>E(T({},t),{attributes:e})))},className:"border-2 mt-4 w-max px-4 py-4 cursor-pointer hover:bg-indigo-600 hover:text-white>\n                text-center font-semibold"},"Add new attribute"))),I("div",null,I("button",{onClick:()=>t(n),className:"border-2 mt-6 w-max px-4 py-4 cursor-pointer hover:bg-indigo-600 hover:text-white\n        text-center font-semibold"},"SAVE"),I("button",{onClick:()=>t(e),className:"border-2 mt-6 ml-4 w-max px-4 py-4 cursor-pointer hover:bg-red-600 hover:text-white\n        text-center font-semibold"},"EXIT WITHOUT SAVING")))},K=({attribute:e,onChangeCallback:t,availableTypes:a})=>{const{label:n,type:l,enumSet:r,subtype:s}=e;return I("div",{className:"border-2 mt-2 px-4 py-4"},"Attribute",I("div",{className:"flex"},I("div",{className:"w-48"},"Label:"),I("input",{className:"border-2",value:n,onInput:a=>{if(a instanceof InputEvent&&a.currentTarget instanceof HTMLInputElement){const n=a.currentTarget.value;t(E(T({},e),{label:n}))}}})),I(Q,{availableTypes:a,type:l,onChange:a=>{t(E(T({},e),{type:a}))}}),l===v.Collection&&I(Z,{onChange:a=>{t(E(T({},e),{subtype:a}))},selected:e.subtype}),l===v.Enum&&I($,{onChange:a=>{t(E(T({},e),{enumSet:a}))},values:e.enumSet}))},Q=({availableTypes:e,type:t,onChange:a})=>{A(ee);return I("div",{className:"flex mt-2"},I("div",{className:"w-48"},"Type:"),I("select",{onChange:e=>{e.currentTarget instanceof HTMLSelectElement&&a(+e.currentTarget.value)},className:"border-2",value:t},e.map((e=>I("option",{value:e,selected:e===t},_(e))))))},Z=({selected:e,onChange:t})=>{const a=A(ee);return I("div",{className:"flex mt-2"},I("div",{className:"w-48"},"Being a group of:"),I("select",{onChange:e=>{e.currentTarget instanceof HTMLSelectElement&&t(e.currentTarget.value)},value:e,className:"border-2"},a.map((e=>I("option",{value:e},e)))))},$=({values:e,onChange:t})=>I("div",null,I("div",{className:"flex mt-2"},I("div",{className:"w-48"},"With values:"),I("div",{className:e?"mr-4":""},null==e?void 0:e.map(((a,n)=>I("div",null,I("input",{className:"border-2",value:a,onInput:a=>((a,n)=>{if(n.currentTarget instanceof HTMLInputElement){const l=null!=e?[...e]:[""];l[a]=n.currentTarget.value,t(l)}})(n,a)},a))))),I("div",{onClick:()=>{if(e){const a=[...e,""];t(a)}else{t([""])}},className:"border-2 h-8 px-4 cursor-pointer hover:bg-indigo-600 hover:text-white"},"Add new option"))),_=e=>{switch(e){case v.Boolean:return"Yes / No";case v.Date:return"Date";case v.Enum:return"Option list";case v.Number:return"Number";case v.Collection:return"Group of other Schema(s)";case v.Optional:return"Optional value";default:return e}},ee=B([""]),te=({store:e})=>{const[t,a]=k(T({index:e.getSchemata.length},{name:"",attributes:[]})),[n,l]=k(!1);L((()=>{a(T({index:e.getSchemata.length},{name:"",attributes:[]}))}),[e]);const r=[...M],{index:s}=t;return I(O,null,I("div",{className:"border-2 mt-4 p-4"},I("h1",{className:"font-semibold text-xl"},"All schemata (click each one to edit):"),0===e.getSchemata.length?I("div",{className:"mt-4"},'No schemata yet! Press "Add new Schema" below to create your first schema.'):e.getSchemata.map(((t,n)=>I("div",{onClick:()=>(t=>{l(!0),a(T({index:t},e.getSchemata[t]))})(n),className:"border-2 mt-2 px-4 py-2 flex cursor-pointer hover:bg-gray-100"},I("span",{className:"w-36 text-2xl"},t.name),I("span",{className:"flex-1 flex content-center"},JSON.stringify(t)))))),!n&&I("button",{onClick:()=>l(!0),className:"border-2 mt-6 w-max px-4 py-4 cursor-pointer hover:bg-indigo-600 hover:text-white\n        text-center font-semibold"},"Add new Schema"),n&&I(ee.Provider,{value:[...e.getSchemata.map((e=>e.name))]},I(X,{schema:t,schemaSpace:r,updateHandler:(o=s,t=>{e.editSchema(o,t),l(!1)}),key:s})));var o};var ae;!function(e){e.Schema="schema",e.Ruleset="ruleset"}(ae||(ae={}));const ne=({store:e})=>{const[t,a]=k(ae.Schema);return I("div",{className:"mt-16 border-gray-200 px-24"},I("h1",null,"CURATOR VIEW"),I("div",{class:"mx-auto mt-4 flex w-48 rounded-md border-2 bg-gray-100"},I("div",{class:"curatorbutton flex-1 w-16 h-10 border-r-2 border-gray-200 cursor-pointer flex items-center justify-center rounded-l-sm \n            "+(t===ae.Schema?"bg-white":""),onClick:()=>a(ae.Schema)},"Schema"),I("div",{class:"consumerbutton flex-1 w-16 h-10 cursor-pointer flex items-center justify-center rounded-r-sm \n            "+(t===ae.Ruleset?"bg-white":""),onClick:()=>a(ae.Ruleset)},"Ruleset")),(t=>{switch(t){case ae.Schema:return I(te,{store:e});case ae.Ruleset:return I(Y,{store:e})}})(t))};class le{constructor(e,t){this.addSchema=e=>{const t=this.ruleStore.schemata.concat(e);this.setFn(E(T({},this.ruleStore),{schemata:t}))},this.editSchema=(e,t)=>{let a=this.ruleStore.schemata.slice();a[e]=t,this.setFn(E(T({},this.ruleStore),{schemata:a}))},this.setFn=t,this.ruleStore=e}get getSchemata(){return this.ruleStore.schemata}}var re;function se(){const[e,t]=k(re.Consumer),[a,n]=k({schemata:[],ruleSets:[]}),l=new le(a,n);return I(O,null,I("div",{class:"App py-10 bg-gray-100"},I("div",{class:"mx-auto mt-4 flex w-48 rounded-md border-2"},I("div",{class:"curatorbutton flex-1 w-16 h-10 border-r-2 border-gray-200 cursor-pointer flex items-center justify-center rounded-l-sm\n            "+(e===re.Curator?"bg-white":""),onClick:()=>t(re.Curator)},"Curator"),I("div",{class:"consumerbutton flex-1 w-16 h-10 cursor-pointer flex items-center justify-center rounded-r-sm\n            "+(e===re.Consumer?"bg-white":""),onClick:()=>t(re.Consumer)},"Consumer"))),I("div",null,(e=>{switch(e){case re.Curator:return I(ne,{store:l});case re.Consumer:return I(J,{store:l})}})(e)))}!function(e){e.Curator="curator",e.Consumer="consumer"}(re||(re={}));j(I(se,null),document.getElementById("app"));
