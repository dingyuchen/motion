var e,t,l,a,n,r,o,s,u,c,i,m,p,d,b,h,v,f,y=Object.defineProperty,g=Object.defineProperties,C=Object.getOwnPropertyDescriptors,N=Object.getOwnPropertySymbols,O=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable,S=(e,t,l)=>t in e?y(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l,T=(e,t)=>{for(var l in t||(t={}))O.call(t,l)&&S(e,l,t[l]);if(N)for(var l of N(t))x.call(t,l)&&S(e,l,t[l]);return e},I=(e,t)=>g(e,C(t));import{l as E,v as w,d as A,y as k,S as M}from"./vendor.39ffd97b.js";(e||(e={})).Lambda="Lambda",(l=t||(t={})).And="And",l.Or="Or",l.Not="Not",(n=a||(a={})).IsBefore="IsBefore",n.IsAfter="IsAfter",n.IsBetween="IsBetween",(o=r||(r={})).MoreThan="MoreThan",o.LessThan="LessThan",o.MoreThanOrEqual="MoreThanOrEqual",o.LessThanOrEqual="LessThanOrEqual",o.Equal="Equal",(u=s||(s={})).Is="Is",u.IsNot="IsNot",(i=c||(c={})).IsChecked="IsChecked",i.IsNotChecked="IsNotChecked",(p=m||(m={})).AllOf="AllOf",p.NoneOf="NoneOf",p.AnyOf="AnyOf",p.NumberOf="NoneOf",(b=d||(d={})).Exists="Exists",b.ExistsAnd="ExistsAnd",(h||(h={})).Lookup="Lookup",(f=v||(v={}))[f.Date=0]="Date",f[f.Number=1]="Number",f[f.Enum=2]="Enum",f[f.Boolean=3]="Boolean",f[f.Collection=4]="Collection",f[f.Optional=5]="Optional",f[f.Model=6]="Model";const B=[0,1,2,3,4,5];function L(e){console.log(e);const[t,l]=E(e),a=[];for(let n of t.attributes){if(n.type===v.Collection){let e={value:n.value};a.push(w(j,T({},e)))}n.type===v.Boolean&&a.push(w("div",null,w("h2",{className:"text-lg inline"},n.label),w("select",{className:"border-2"},w("option",null,"True"),w("option",null,"False")))),n.type===v.Number&&a.push(w("div",null,w("h2",{className:"text-lg inline"},n.label),w("input",{type:"number",className:"border-2"}))),n.type===v.Enum&&a.push(w("div",null,w("h2",{className:"text-lg inline"},n.label),w("select",null)))}return w(A,null,w("div",{class:"w-11/12 min-w-max bg-white p-4 ml-1 border-2"},w("h1",{class:"text-2xl border-gray-300 text-gray-900 text-left"},t.label),a))}const j=e=>{const t=[];for(const[l,a]of e.value.entries())t.push(w("div",{className:"flex"},w("div",{className:"text-lg w-16 border-2 flex justify-center items-center"},l),w("div",{className:"flex-1"},w(L,T({},a)))));return w("div",{className:"border-2 p-4 my-4"},w("h2",{className:"text-lg"},"Collection of ",e.value[0].label),t)};function q(){const e={attributes:[{label:"vaccinated",type:v.Boolean,value:!0},{label:"age",type:v.Number,value:90}],type:v.Model,label:"person"},t={attributes:[{label:"vaccinated",type:v.Boolean,value:!1},{label:"age",type:v.Number,value:30}],type:v.Model,label:"person"},l={attributes:[{label:"group",type:v.Collection,value:[e,t]},{label:"same household",type:v.Boolean,value:!0}],type:v.Model,label:"group"},[a,n]=E(l);return w(A,null,w("div",{className:"mt-16"},w("h1",null,"CONSUMER VIEW"),w(L,T({},a))))}const H=(e,t,l)=>{const a=e.slice(0);return a[t]=l,a},P=({schema:e,updateHandler:t,schemaSpace:l})=>{const[a,n]=E(e),{attributes:r}=a,o=e=>t=>{n((l=>{const{attributes:a}=l;return I(T({},l),{attributes:H(a,e,t)})}))};return w("div",null,w("div",null,"Schema builder",w("div",null,w("input",{type:"text",label:"Name",onInput:e=>{if(e instanceof InputEvent&&e.currentTarget instanceof HTMLInputElement){const t=e.currentTarget.value;n((e=>I(T({},e),{name:t})))}}})),"Attributes:",r.map(((e,t)=>w(D,{attribute:e,availableTypes:l,onChangeCallback:o(t)}))),w("button",{onClick:()=>{const e=r.concat({label:"",type:v.Boolean});n((t=>I(T({},t),{attributes:e})))}},"Add new attribute")),w("button",{onClick:()=>t(a)},"Done"))},D=({attribute:e,onChangeCallback:t,availableTypes:l})=>{const{label:a,type:n,enumSet:r,subtype:o}=e,s=l=>{t(I(T({},e),{type:l}))};return w("div",null,"Attribute",w("div",null,"Label:"),w("input",{placeholder:a,onInput:l=>{if(l instanceof InputEvent&&l.currentTarget instanceof HTMLInputElement){console.log(l.currentTarget.value);const a=l.currentTarget.value;t(I(T({},e),{label:a}))}}}),w(F,{availableTypes:l,type:n,onChange:s}),(n===v.Collection||n===v.Optional)&&w("div",null,"Subtype:",w(F,{availableTypes:l,type:n,onChange:s})))},F=({availableTypes:e,type:t,onChange:l})=>w(A,null,w("div",null,"Type:"),w("select",{onChange:e=>{e.currentTarget instanceof HTMLSelectElement&&l(e.currentTarget.value)}},e.map((e=>w("option",{value:e,selected:e===t},R(e)))))),R=e=>e,U=({store:e})=>{const[t,l]=E(T({index:e.getSchemata.length},{name:"",attributes:[]})),[a,n]=E(!1);k((()=>{l(T({index:e.getSchemata.length},{name:"",attributes:[]}))}),[e]);const r=[...B,...e.getSchemata.map((e=>e.name))],{index:o}=t;return w(A,null,w("div",null,"Schema editor"),w("div",null,"All models:"),e.getSchemata.map(((t,a)=>w("div",{onClick:()=>(t=>{n(!0),l(T({index:t},e.getSchemata[t]))})(a)},JSON.stringify(t)))),!a&&w("button",{onClick:()=>n(!0)},"Add new Schema"),a&&w(P,{schema:t,schemaSpace:r,updateHandler:(s=o,t=>{e.editSchema(s,t),n(!1)})}));var s},V=({store:e})=>w("div",{className:"mt-16 border-2 border-gray-200"},w("h1",null,"CURATOR VIEW"),w(U,{store:e}));class W{constructor(e,t){this.addSchema=e=>{const t=this.ruleStore.schemata.concat(e);this.setFn(I(T({},this.ruleStore),{schemata:t}))},this.editSchema=(e,t)=>{let l=this.ruleStore.schemata.slice();l[e]=t,this.setFn(I(T({},this.ruleStore),{schemata:l}))},this.setFn=t,this.ruleStore=e}get getSchemata(){return this.ruleStore.schemata}}var J,z;function G(){const[e,t]=E(J.Consumer),[l,a]=E({schemata:[],ruleSets:[]}),n=new W(l,a);return w(A,null,w("div",{class:"App py-10 bg-gray-100"},w("div",{class:"mx-auto mt-4 flex w-48 rounded-md border-2"},w("div",{class:"consumerbutton flex-1 w-16 h-10 border-r-2 border-gray-200 cursor-pointer flex items-center justify-center",onClick:()=>t(J.Curator)},"Curator"),w("div",{class:"consumerbutton flex-1 w-16 h-10 cursor-pointer flex items-center justify-center",onClick:()=>t(J.Consumer)},"Consumer"))),w("div",null,(e=>{switch(e){case J.Curator:return w(V,{store:n});case J.Consumer:return w(q,null)}})(e)))}(z=J||(J={})).Curator="curator",z.Consumer="consumer";M(w(G,null),document.getElementById("app"));
